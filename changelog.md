# 更新日志

---

## v2.26.02.003（2026-02-12 ~ 2026-02-25）

## 2026-02-25

### 服务器详情页

- 网络设备区域：管理员配置的主网卡卡片右上角新增蓝色斜角"主网卡"标签，一目了然；其他网卡（容器/VPN/回环等）归入"其他网卡"折叠组，点击可展开明细。

### 服务器管理

- 编辑服务器页面网卡推荐区优化：提示文案精简、当前生效网卡高亮展示，截断提示位置调整，分割线样式统一。

---

## 2026-02-23

### 服务器管理

- 修复编辑服务器页面中“账单周期=自定义周期”时，自定义周期天数输入未显示的问题；切换为自定义后会立即展示并参与保存。
- 修复新增服务器页面账单周期字段口径不一致问题：自定义周期天数可正确显示、校验并写入配置。
- 编辑服务器页面的“网络设备”新增推荐下拉：支持查看推荐网卡与全部网卡，并显示每张网卡的累计总流量（In+Out）供人工确认。
- 主动上报与被动采集的网卡口径已统一：配置了网络设备时将按该网卡统计；若配置网卡未出现在最近上报中，系统会跳过该周期入账并给出告警。

### 数据存储与清理

- 新增 Agent 任务数据保留策略：默认保留任务 7 天、任务结果 3 天；系统按策略定时清理历史数据，减少数据库持续膨胀。
- 优化 SQLite 清理脚本：清理与 VACUUM 后自动执行 WAL checkpoint(TRUNCATE)，并按 `db+wal+shm` 统计实际释放空间，避免“主库变小但总占用看起来不变”的误判。

---

## 2026-02-22

### 服务器管理

- 新增/编辑服务器的 SSH 私钥区域增加「导入私钥」入口：可按服务器名搜索并选择已有节点作为私钥来源。
- 导入后保存时由后端直接复制来源节点的私钥与 passphrase，前端不接触私钥明文；若用户手动输入新私钥，则手动输入优先。
- 服务器列表中的「复制安装命令 / 复制重装命令」改为按节点当前模式生成一行命令：主动模式自动追加 `active-report`，被动模式按端口自动生成参数；不再依赖自动发现注册密钥。

### 通知消息

- 通知标题增加对象名，如「服务器掉线 | HK-01」，Telegram / 邮件 / Webhook 统一生效。
- 修复通知来源在站点未配置时显示异常的问题。

### 问题修复

- 修复主题默认策略在部分场景下未按预期生效的问题。
- 修复标签删除后页面未实时刷新的问题。
- 修复管理后台会话过期时页面报错的问题。
- 修复动态登录路由启用后，会话过期仍跳转 `/admin-login` 的问题，统一改为 `/login?redirect=...`。

---

## 2026-02-14

### 网络质量

- 网络质量图表标题支持点击跳转节点详情页（`/stats/:sid`）。
- 1小时历史数据默认粒度调整为5分钟，曲线更精细。

### 探针配置

- 探针模式支持双态切换与分阶段操作，主动/被动模式切换体验优化。
- 调度设置新增最大并发测试数与每节点最大并发数默认值配置。

### 问题修复

- 修复网络下载/上传档位徽章首帧不升档、档位进度条与徽章不同步的问题。
- 修复 2FA 登录成功后页面闪屏问题，现在直接跳转。
- 修正账单 Top5 节点详情页跳转路径错误的问题。

---

## 2026-02-13

### 设置中心

- 基础设置与高级设置合并为"设置中心"单页，旧路由自动跳转，无需在两个页面之间切换。

### 分享功能

- 节点详情页新增"创建分享"快捷入口，支持全链路访问鉴权。
- 分享页布局全面优化：字段对齐、自定义秒数显示、输入框样式、标题图标配色统一。

---

## 2026-02-12

### 服务器管理

- 服务器管理页（`/admin/servers`）支持从列表直接打开节点详情页（`/stats/:sid`）；桌面端"编辑"旁新增"详情"按钮，移动端"更多"菜单新增"查看详情"入口。

### 授权管理

- 授权管理页状态标签统一样式："已连接 / 离线模式 / 应急模式 / 检查中 / 连接异常"使用同一套标签，移动端与窄屏下显示更稳定，不再出现换行或文字溢出。

### AI 设置

- 管理端支持配置 license_proxy AI 模型，接入后端代理能力。

---

## 2.26.02.002（2026-02-10）

### 个性化与主题

- 新增全站"默认主题模式"设置：支持"跟随系统 / 日间 / 夜间"。
- 所有设备都会按后台默认主题模式显示，不再被历史本地主题缓存覆盖。
- 增加历史主题缓存温和迁移，避免旧版本遗留 `theme/theme_mode` 导致显示异常。

### 优化改进

- 终端 Agent 在调用工具前会先说明：要做什么、目的是什么、下一步会怎么做。
- 长命令执行中增加关键节点进度播报，避免长时间无反馈。
- 命令执行后会先给结果要点，再给下一步建议，排障路径更清晰。
- 当步骤额度接近上限时，系统会保留总结步骤，避免停在工具回执。

### 问题修复

- 修复部分场景下命令执行完成但未输出最终总结的问题。
- 修复仅有工具回执时会话停在执行态的体验问题。
- 修复卡片视图流量悬浮提示在超大流量上限场景显示 `undefined` 的问题。

---

## 2.26.02.001（2026-02-08）

### 新增功能

**终端 AI 助手（ASK/YOLO 双模式）**

- **双模式支持**：
  - ASK 模式：AI 提供诊断建议与具体命令，需用户确认后执行，适合谨慎操作。
  - YOLO 模式：AI 自动进行连续诊断与操作，减少重复确认步骤，提升排障效率。
- **智能辅助**：支持联网检索实时信息辅助判断，并自动读取节点上下文作为诊断依据。
- **会话管理**：终端页支持创建、切换及删除会话；实时显示 Token 用量（如 45k / 200k），长对话触发历史压缩策略以保持稳定性。

**SSH 连接增强**

- **Tmux 集成**：WebSSH 默认优先使用 tmux 会话，连接断开后可恢复；检测到 tmux 缺失时提供自动安装引导，并支持降级回退至普通 Shell。
- **体验优化**：刷新页面后可恢复本地终端输出缓存；支持配置一次性 SSH 命令执行；终端主题支持跟随系统或手动切换（自动/亮色/暗色）。

**Telegram Bot 远程排障**

- **交互诊断**：支持在 Telegram 私聊中直接发起 AI 问答与服务器排障。
- **安全执行**：远程命令执行前增加确认机制，防止误操作；支持按行号或关键词检索历史输出日志。

**主动探针（Agent）管理**

- **管理面板**：服务器管理页新增"主动探针"面板，可查看节点在线状态、版本、任务队列及 TCP/UDP 连接数。
- **运维操作**：支持在节点编辑页进行安装、升级、检测及卸载操作。
- **升级机制**：优化 Linux amd64/arm64 升级链路，优先使用 SSH 通道，失败时自动转为任务下发；增加升级包校验与回滚保护。

**安全与诊断工具**

- **域名分离**：安全设置支持前后台域名分离配置，支持生成 Nginx、宝塔、1Panel 及 Caddy 反代配置片段，并提供预检功能。
- **手动诊断**：新增 MTR 路由追踪与 iperf3 带宽测试工具，支持任务入队执行，iperf3 测试结果提供可视化图表。

### 优化改进

**服务器管理界面布局优化**

- **Tab 布局**：新增/编辑服务器页面改为 Tab 切换布局，信息分组更清晰。
- **功能整合**：探针管理功能整合到基础配置，SSH 连接配置、地理位置与备注改为独立卡片展示。
- **操作优化**：国旗与地区选择支持"自动定位"与"手动选择"双模式。

**其他体验优化**

- **流量校准**：支持输入负值进行向下校准，方便修正流量统计偏差。
- **界面细节**：手动诊断页面调整为左侧导航布局；统一卡片样式；优化标签悬浮提示与溢出显示（支持显示 +N）。

### 问题修复

**连接稳定性**

- 修复 Agent 运行中因 tmux 缺失导致的连接阻断问题，自动回退至普通 WebSSH。

**数据准确性**

- 修复升级回传结果重复写入的问题。
- 修正节点离线时间的显示误差。

**显示异常**

- 修复终端在亮色模式下对比度不足的问题。
- 修复网络质量页面配置同步延迟问题。
- 修复流量图表滚动后消失或闪烁的问题。
- 修复标签自适应数量限制（提升至 5 个）。

---

## 2.25.12.005（2025-12-30）

### 新增
- 支持按流量计费的多种模式：超量收费、纯流量计费、阶梯计费、流量包
- 管理端新增阶梯/流量包的配置入口，可设置用量区间与单价
- 支持账单调整（减免/补收），可填写原因便于对账

### 改进
- 计费说明更清晰：校准只影响展示，费用按实际用量统计
- 流量包支持"用完自动续购"的设置，避免中断
- 剩余价值标签货币符号调整：显示为 5¥ 而非 ¥5，更符合阅读习惯
- 资产预览游客可见设置生效：关闭后游客访问单节点页面不显示剩余价值

---

## 2.25.12.004（2025-12-27）

### 改进
- 通知设置入口更集中：告警规则并入通知设置页面，配置与管理更直观
- IP 信息页面布局更清晰：检测证据摘要改为卡片网格，阅读更轻松，移动端更友好

### 修复
- 解决部分页面结构重复导致的维护与显示问题（用户侧表现为更稳定、更一致）

---

## 2.25.12.003（2025-12-20）

### 新增
- 支持 IP 地理位置功能（可在高级设置中配置 Key）
- 支持"离线节点后置"显示：离线节点可自动排到列表末尾

### 改进
- IP 质量检测页面体验优化：补齐常用服务信息与图标，操作更顺手
- 3D 地球功能更稳定：减少异常动画与展示不一致的问题

### 修复
- 修复网络监控中丢包率显示为 0% 的问题

---

## 2.25.12.001（2025-12-12）

### 新增
- 网速单位可切换：支持 bps 与 B/s，并在主要页面保持一致
- 服务器备忘录：在新增/编辑服务器时可记录关键信息
- 网络质量曲线可配置：可控制图表曲线数量与悬停提示条目上限

### 改进
- 通知系统更稳定：配置更顺畅、测试更可靠
- 监控数据显示更准确：离线时间、带宽与月流量提示信息更完整

---

更早版本与草稿归档见：[GitHub 仓库](https://github.com/fev125/dstatus)
