# 通知设置（通知渠道 / 通知类型 / 告警规则）

## 入口

管理后台 → 通知设置（`/admin/notification`）

## 先用起来（最短路径）

1. 先配置至少一个通知渠道（Telegram / 邮件 / Webhook）
2. 在“通知类型”里勾选你希望接收的事件
3. 发送测试通知，确认能收到

## 通知渠道（渠道 Tab）

### Telegram

你需要配置：

- Bot 令牌
- Chat IDs（接收人）

建议：

- “离线通知延迟”别设太短（默认是 30 秒）
- “流量阈值”按你的习惯调整（默认是 80/90/95）

配置完点“测试”，确认能收到。

### 邮件

你需要配置：

- SMTP 服务器与端口
- 发件人与收件人（To）
- 账号与密码（建议用应用专用密码）

配置完点“测试”，确认能收到。

### Webhook

适合把通知转发到你自己的系统（例如工单/群机器人/自建告警平台）。

配置完点“发送测试消息”，确认你的 Webhook 能收到。

## 通知类型（类型 Tab）

这里控制“哪些事件要发通知”，并且可以按渠道分别开关（Telegram/邮件/Webhook）。

如果你配置了渠道，但还是收不到，优先来这里确认对应事件是否启用。

## 告警规则（规则 Tab）

这里是“自动告警”：你设置规则，触发后会通过已配置的渠道发送。

当前规则偏向阈值类（例如流量/CPU/内存/磁盘）。

## 事件中心 / 投递追踪

- 事件中心：看最近发生了哪些通知事件
- 投递追踪：看通知是否发送成功，失败原因是什么（例如无收件人、超时、通道不可用）

## 常见问题

### 能测试成功，但实际没通知

因为你没打开对应事件，或者事件没触发，所以收不到：

- 去“通知类型”里确认对应事件已启用
- 确认事件确实发生（例如节点离线/上线、流量达到阈值）

### 测试通知失败

因为面板发不出去，所以测试会失败：

- 检查面板所在服务器的网络/防火墙
- Telegram：确认 Bot 令牌与 Chat ID 填写正确
- 邮件：确认 SMTP 配置与收件人填写正确
- Webhook：确认你的 Webhook 地址可访问
